kind: PersistentVolumeClaim
apiVersion: v1
metadata:
  name: products-data
  labels:
    app: products-data
spec:
  accessModes:
    - ReadWriteOnce
  resources:
    requests:
      storage: 200Gi
  storageClassName: default
---
apiVersion: v1
kind: ConfigMap
metadata:
  name: products-csv
data:
  ProductList.csv: |
    Product,ProductID,AcquisitionDate,Size,CollectionID
    Sentinel-2,L2A_T52SCG_A025883_20200606T021609,2020-06-06T02:16:11.024Z,1.08 GB,088e3a13-37bf-4501-a554-c1236b539773
    Sentinel-2,L2A_T52SCG_A025311_20200427T021605,2020-04-27T02:16:11.024Z,1.08 GB,a4bb0361-c2e6-42e5-a98a-20650026a5b7
    Sentinel-2,L1C_T52SCG_A025311_20200427T021605,2020-04-27T02:16:11.024Z,818.22 MB,71c675b3-a814-4c97-bfe4-19fd17dbfaa2
    Sentinel-2,L2A_T52SCG_A016331_20200422T021557,2020-04-22T02:15:59.024Z,1002.92 MB,bbd3587b-f168-4379-80d7-702f5e5daa3a
    Sentinel-2,L1C_T52SCG_A016331_20200422T021557,2020-04-22T02:15:59.024Z,790.82 MB,bcf233c9-7832-4890-ba41-ce334dc7d458
    Sentinel-2,L2A_T52SCG_A025168_20200417T021603,2020-04-17T02:16:01.024Z,871.96 MB,0fdeb703-f78a-48d6-8557-0ae5568c5100
    Sentinel-2,L1C_T52SCG_A025168_20200417T021603,2020-04-17T02:16:01.024Z,702.26 MB,8b19c974-45c8-41b8-ace7-b3d855b470ac
    Sentinel-2,L2A_T52SCG_A016188_20200412T021559,2020-04-12T02:15:59.024Z,920.19 MB,4b805799-2963-4476-a7ed-255a4551afc7
    Sentinel-2,L1C_T52SCG_A016188_20200412T021559,2020-04-12T02:15:59.024Z,711.48 MB,c0ac36a9-f8d2-4a2d-9d89-35c2cdc425ad
    Sentinel-2,L2A_T52SCG_A025025_20200407T021600,2020-04-07T02:16:01.024Z,1.06 GB,3e676df0-5c3c-4ba5-8403-4cf2670e4c89
    Sentinel-2,L1C_T52SCG_A025025_20200407T021600,2020-04-07T02:16:01.024Z,776.57 MB,cce0895c-c817-41a6-be4d-d942f510f773
    Sentinel-2,L2A_T52SCG_A016045_20200402T021600,2020-04-02T02:15:59.024Z,1.08 GB,f7d1323b-7952-4fa2-a7da-0fca7dc1c5fd
    Sentinel-2,L1C_T52SCG_A016045_20200402T021600,2020-04-02T02:15:59.024Z,798.52 MB,eae202c3-ba74-4f61-a60b-464a4877ed24
    Sentinel-2,L2A_T52SCG_A024882_20200328T021559,2020-03-28T02:16:01.024Z,913.10 MB,ee8ccb95-2f33-47e8-aac4-f44b72b74759
    Sentinel-2,L1C_T52SCG_A024882_20200328T021559,2020-03-28T02:16:01.024Z,730.65 MB,4fcd4657-da50-4c8b-a41f-2384af05090f
    Sentinel-2,L2A_T52SCG_A015902_20200323T021601,2020-03-23T02:15:59.024Z,1.14 GB,ffb18c57-6d29-4859-9dc7-8d10730c62a5
    Sentinel-2,L1C_T52SCG_A015902_20200323T021601,2020-03-23T02:15:59.024Z,824.24 MB,7682717f-9e7a-4ffc-ae1b-eed8228aa784
    Sentinel-2,L2A_T52SCG_A024739_20200318T021559,2020-03-18T02:16:01.024Z,1.15 GB,13bd0409-734b-4b0f-bc5d-e77da980cc22
    Sentinel-2,L1C_T52SCG_A024739_20200318T021559,2020-03-18T02:16:01.024Z,839.28 MB,31e11b2a-8636-4da4-944e-9de0c38deb1f
    Sentinel-2,L2A_T52SCG_A015759_20200313T021601,2020-03-13T02:15:59.024Z,1.05 GB,3a3506d6-2d14-420f-af41-f61a41b0c28c
    Sentinel-2,L1C_T52SCG_A015759_20200313T021601,2020-03-13T02:15:59.024Z,788.74 MB,27584095-9396-44ed-805e-d7eebee060dc
    Sentinel-2,L2A_T52SCG_A024596_20200308T021559,2020-03-08T02:16:01.024Z,1.13 GB,a8ffe326-8889-491c-857e-920ed535455c
    Sentinel-2,L1C_T52SCG_A024596_20200308T021559,2020-03-08T02:16:01.024Z,830.22 MB,e95754e3-2311-44fb-98ae-68f3acabb9b9
    Sentinel-2,L2A_T52SCG_A015616_20200303T021602,2020-03-03T02:15:59.024Z,984.77 MB,c39258d8-3262-49d1-8108-14858aeca42b
    Sentinel-2,L1C_T52SCG_A015616_20200303T021602,2020-03-03T02:15:59.024Z,799.59 MB,aebbb6cf-eb2c-43e8-9d78-1fb0168599d7
    Sentinel-2,L2A_T52SCG_A024453_20200227T021634,2020-02-27T02:16:31.024Z,1.07 GB,2eb4e616-e1ec-4a23-93bc-2466a6afe586
    Sentinel-2,L1C_T52SCG_A024453_20200227T021634,2020-02-27T02:16:31.024Z,842.29 MB,055239fa-b2bc-4680-b755-326ed54bff1e
    Sentinel-2,L2A_T52SCG_A015473_20200222T021711,2020-02-22T02:17:09.024Z,1019.06 MB,b15bb23d-67ee-451b-90f8-0dc6bfe9f9ec
    Sentinel-2,L1C_T52SCG_A015473_20200222T021711,2020-02-22T02:17:09.024Z,780.30 MB,30c38355-5e01-4498-a3a4-3334f35ef7f3
    Sentinel-2,L2A_T52SCG_A024310_20200217T021741,2020-02-17T02:17:41.024Z,1016.33 MB,5ded927d-c9ae-47e1-a924-a3742fda8f45
    Sentinel-2,L1C_T52SCG_A024310_20200217T021741,2020-02-17T02:17:41.024Z,795.30 MB,1085bf38-8f5d-4f07-825e-8fd01f781fa0
    Sentinel-2,L2A_T52SCG_A015330_20200212T021815,2020-02-12T02:18:19.024Z,872.38 MB,45761299-3759-4673-844d-dea0cd4ab526
    Sentinel-2,L1C_T52SCG_A015330_20200212T021815,2020-02-12T02:18:19.024Z,640.17 MB,f1763b56-afad-47a1-ba64-357c98c79b0b
    Sentinel-2,L2A_T52SCG_A024167_20200207T021842,2020-02-07T02:18:41.024Z,1.03 GB,dbe96b8a-84b1-4c9c-93fd-3f7f4aa20ca7
    Sentinel-2,L1C_T52SCG_A024167_20200207T021842,2020-02-07T02:18:41.024Z,774.81 MB,6aafe665-9ebd-43a1-9db5-dd0c40217429
    Sentinel-2,L2A_T52SCG_A015187_20200202T021911,2020-02-02T02:19:09.024Z,838.42 MB,8c68c73a-d68f-4453-9523-8517a6ba7d3f
    Sentinel-2,L1C_T52SCG_A015187_20200202T021911,2020-02-02T02:19:09.024Z,695.17 MB,1de69c7d-d695-4d14-a0b0-35a74cbb75e3
    Sentinel-2,L2A_T52SCG_A024024_20200128T021937,2020-01-28T02:19:41.024Z,876.10 MB,2246cdfa-2b80-4271-84d7-961effe1072d
    Sentinel-2,L1C_T52SCG_A024024_20200128T021937,2020-01-28T02:19:41.024Z,706.06 MB,d8b1df26-2127-4166-b33b-680719065f03
    Sentinel-2,L2A_T52SCG_A015044_20200123T022001,2020-01-23T02:19:59.024Z,1.11 GB,52d6795d-cd74-4930-951f-76d06a344bf7
    Sentinel-2,L1C_T52SCG_A015044_20200123T022001,2020-01-23T02:19:59.024Z,821.65 MB,febc65f9-60ea-4f4a-ae3a-15c3b520488e
    Sentinel-2,L2A_T52SCG_A023881_20200118T022020,2020-01-18T02:20:21.024Z,1.11 GB,cb26f539-9e64-49f2-b749-2b2115381ae4
    Sentinel-2,L1C_T52SCG_A023881_20200118T022020,2020-01-18T02:20:21.024Z,832.48 MB,bd55b8c9-c711-4eb8-a778-8e1ed3e139de
    Sentinel-2,L2A_T52SCG_A014901_20200113T022038,2020-01-13T02:20:39.024Z,1.09 GB,1877891a-3b49-4f35-817f-29aeb28efcd3
    Sentinel-2,L1C_T52SCG_A014901_20200113T022038,2020-01-13T02:20:39.024Z,829.34 MB,545c3e3c-9767-40b0-9448-c242da1fd440
    Sentinel-2,L2A_T52SCG_A023738_20200108T022050,2020-01-08T02:20:51.024Z,825.16 MB,796708ef-5528-42ad-9549-b8131c090b6a
    Sentinel-2,L1C_T52SCG_A023738_20200108T022050,2020-01-08T02:20:51.024Z,640.21 MB,fb31ed56-804d-4508-a69e-603ff0c45dec
    Sentinel-2,L2A_T52SCG_A014758_20200103T022101,2020-01-03T02:20:59.024Z,1.08 GB,06137069-ad32-498c-a331-a801b3425b38
    Sentinel-2,L1C_T52SCG_A014758_20200103T022101,2020-01-03T02:20:59.024Z,811.13 MB,03ecc8a2-eb29-42c6-9a55-746e3567fc5f
  LeftProduct.csv: |
    Product,ProductID,AcquisitionDate,Size,CollectionID

---

apiVersion: apps/v1beta1
kind: Deployment
metadata:
  name: sentinels0
  namespace: default
spec:
  replicas: 1
  template:
    metadata:
      labels:
        app: sentinels0
    spec:
      containers:
        - name: sentinels0
          image: zerofruit/sentinel:latest
          imagePullPolicy: Always
          volumeMounts:
            - name: products-data
              mountPath: /usr/src/app/s
            - name: products-csv
              mountPath: /usr/src/app/csv
          command: ["npm"]
          args: ["run", "keep"]
          env:
            - name: SUBDIR
              value: "1"
          ports:
            - containerPort: 7070
          readinessProbe:
            httpGet:
              path: /
              port: 7070
            timeoutSeconds: 10
      volumes:
        - name: products-csv
          configMap:
            name: products-csv
        - name: products-data
          persistentVolumeClaim:
            claimName: products-data

---

apiVersion: v1
kind: Service
metadata:
  name: sentinels0
spec:
  type: LoadBalancer
  ports:
    - port: 80
      targetPort: 7070
  selector:
    app: sentinels

